/** @license sf2synth.js 2013 - imaya / GREE Inc. [ https://github.com/gree/sf2synth.js ] The MIT License */(function() {'use strict';var l,p=this;function t(b,d){var a=b.split("."),c=p;a[0]in c||!c.execScript||c.execScript("var "+a[0]);for(var f;a.length&&(f=a.shift());)a.length||void 0===d?c=c[f]?c[f]:c[f]={}:c[f]=d};function v(b,d,a){this.a=b;this.destination=d;this.b=a;this.channel=a.channel;this.key=a.key;this.Qa=a.velocity;this.buffer=a.sample;this.playbackRate=a.basePlaybackRate;this.sampleRate=a.sampleRate;this.volume=a.volume;this.ka=a.panpot;this.m=a.pitchBend;this.n=a.pitchBendSensitivity;this.Aa=a.modEnvToPitch;this.h=a.expression;this.startTime=b.currentTime;this.M=this.playbackRate;this.ja=!1}l=v.prototype;
l.noteOn=function(){var b=this.a,d=this.b,a=this.buffer,c,f,e,g=this.a.currentTime,h=g+d.volDelay,q=g+d.modDelay,k=h+d.volAttack+d.volHold,m=h+d.modAttack+d.modHold,n=k+d.volDecay,r=m+d.modDecay;f=d.loopStart/this.sampleRate;e=d.loopEnd/this.sampleRate;var s=d.start/this.sampleRate,u,a=a.subarray(0,a.length+d.end);c=this.ra=b.createBuffer(1,a.length,this.sampleRate);c.getChannelData(0).set(a);a=this.W=b.createBufferSource();a.buffer=c;a.loop=1===(d.sampleModes&1);a.loopStart=f;a.loopEnd=e;A(this,
this.m);c=b.createPanner();f=this.N=b.createGain();e=f.gain;this.s=b.createGain();this.s.gain.value=this.h/127;b=this.filter=b.createBiquadFilter();b.type=b.LOWPASS;c.panningModel=0;c.setPosition(Math.sin(this.ka*Math.PI/2),0,Math.cos(this.ka*Math.PI/2));u=this.Qa/127*this.volume*(1-d.initialAttenuation/1E3);0>u&&(u=0);e.setValueAtTime(0,g);e.setValueAtTime(0,h);e.setValueAtTime(u,k);e.linearRampToValueAtTime(u*(1-d.volSustain),n);b.Q.setValueAtTime(d.initialFilterQ*Math.pow(10,200),g);h=B(d.initialFilterFc);
k=B(d.initialFilterFc+d.modEnvToFilterFc);n=h+(k-h)*(1-d.modSustain);b.frequency.setValueAtTime(h,g);b.frequency.setValueAtTime(h,q);b.frequency.setValueAtTime(k,m);b.frequency.linearRampToValueAtTime(n,r);a.connect(b);b.connect(c);c.connect(this.s);this.s.connect(f);d.mute||this.connect();a.start(0,s)};function B(b){return 440*Math.pow(2,(b-6900)/1200)}l.noteOff=function(){this.ja=!0};
l.release=function(){var b=this.b,d=this.W,a=this.N,c=this.a.currentTime,f=b.releaseTime-64,f=c+b.volRelease*a.gain.value*(1+f/(0>f?64:63)),e=this.filter,g=B(b.initialFilterFc),h=B(b.initialFilterFc+b.modEnvToFilterFc),h=c+b.modRelease*(g===h?1:(e.frequency.value-g)/(h-g));if(this.ra)switch(b.sampleModes){case 1:a.gain.cancelScheduledValues(0);a.gain.setValueAtTime(a.gain.value,c);a.gain.linearRampToValueAtTime(0,f);e.frequency.cancelScheduledValues(0);e.frequency.setValueAtTime(e.frequency.value,
c);e.frequency.linearRampToValueAtTime(g,h);d.playbackRate.cancelScheduledValues(0);d.playbackRate.setValueAtTime(d.playbackRate.value,c);d.playbackRate.linearRampToValueAtTime(this.M,h);d.stop(f);break;case 2:p.console.log("detect unused sampleModes");break;case 3:d.loop=!1}};l.connect=function(){this.N.connect(this.destination)};l.disconnect=function(){this.N.disconnect(0)};
function A(b,d){b.M=b.playbackRate*Math.pow(Math.pow(2,1/12),d/(0>d?8192:8191)*b.n*b.b.scaleTuning);var a=b.W.playbackRate,c=b.M,f=b.startTime,e=b.b,g=f+e.modAttack,h=g+e.modDecay,q=c*Math.pow(Math.pow(2,1/12),b.Aa*b.b.scaleTuning);a.cancelScheduledValues(0);a.setValueAtTime(c,f);a.linearRampToValueAtTime(q,g);a.linearRampToValueAtTime(c+(q-c)*(1-e.modSustain),h)};function C(b,d){d=d||{};this.input=b;this.j=d.index||0;this.length=d.length||b.length-this.j;this.offset=this.j;this.padding=void 0!==d.padding?d.padding:!0;this.ta=void 0!==d.bigEndian?d.bigEndian:!1}function ga(b,d,a){this.type=b;this.size=d;this.offset=a}
C.prototype.parse=function(){var b=this.length+this.offset;for(this.e=[];this.j<b;){var d=this.input,a=this.j,c=void 0;this.e.push(new ga(String.fromCharCode(d[a++],d[a++],d[a++],d[a++]),c=this.ta?(d[a++]<<24|d[a++]<<16|d[a++]<<8|d[a++])>>>0:(d[a++]|d[a++]<<8|d[a++]<<16|d[a++]<<24)>>>0,a));a+=c;this.padding&&1===(a-this.offset&1)&&a++;this.j=a}};function D(b,d){var a=b.e[d];return void 0===a?null:a};function G(b,d){d=d||{};this.input=b;this.Ea=d.parserOption}
G.prototype.parse=function(){var b,d,a=new C(this.input,this.Ea);a.parse();if(1!==a.e.length)throw Error("wrong chunk length");a=D(a,0);if(null===a)throw Error("chunk not found");var c=this.input,f=a.offset,e;if("RIFF"!==a.type)throw Error("invalid chunk type:"+a.type);e=String.fromCharCode(c[f++],c[f++],c[f++],c[f++]);if("sfbk"!==e)throw Error("invalid signature:"+e);a=new C(c,{index:f,length:a.size-4});a.parse();if(3!==a.e.length)throw Error("invalid sfbk structure");c=D(a,0);f=this.input;e=c.offset;
var g;if("LIST"!==c.type)throw Error("invalid chunk type:"+c.type);g=String.fromCharCode(f[e++],f[e++],f[e++],f[e++]);if("INFO"!==g)throw Error("invalid signature:"+g);(new C(f,{index:e,length:c.size-4})).parse();c=D(a,1);f=this.input;e=c.offset;if("LIST"!==c.type)throw Error("invalid chunk type:"+c.type);g=String.fromCharCode(f[e++],f[e++],f[e++],f[e++]);if("sdta"!==g)throw Error("invalid signature:"+g);c=new C(f,{index:e,length:c.size-4});c.parse();if(1!==c.e.length)throw Error("TODO");this.qa=
D(c,0);a=D(a,2);c=this.input;f=a.offset;if("LIST"!==a.type)throw Error("invalid chunk type:"+a.type);e=String.fromCharCode(c[f++],c[f++],c[f++],c[f++]);if("pdta"!==e)throw Error("invalid signature:"+e);a=new C(c,{index:f,length:a.size-4});a.parse();if(9!==a.e.length)throw Error("invalid pdta chunk");c=D(a,0);f=this.input;e=c.offset;g=this.Ha=[];var h=c.offset+c.size;if("phdr"!==c.type)throw Error("invalid chunk type:"+c.type);for(;e<h;)g.push({Ia:String.fromCharCode.apply(null,f.subarray(e,e+=20)),
Ga:f[e++]|f[e++]<<8,o:f[e++]|f[e++]<<8,ma:f[e++]|f[e++]<<8,Sa:(f[e++]|f[e++]<<8|f[e++]<<16|f[e++]<<24)>>>0,Ra:(f[e++]|f[e++]<<8|f[e++]<<16|f[e++]<<24)>>>0,Ta:(f[e++]|f[e++]<<8|f[e++]<<16|f[e++]<<24)>>>0});c=D(a,1);f=this.input;e=c.offset;g=this.Ja=[];h=c.offset+c.size;if("pbag"!==c.type)throw Error("invalid chunk type:"+c.type);for(;e<h;)g.push({na:f[e++]|f[e++]<<8,R:f[e++]|f[e++]<<8});c=D(a,2);if("pmod"!==c.type)throw Error("invalid chunk type:"+c.type);this.pa=H(this,c);c=D(a,3);if("pgen"!==c.type)throw Error("invalid chunk type:"+
c.type);this.oa=I(this,c);c=D(a,4);f=this.input;e=c.offset;g=this.b=[];h=c.offset+c.size;if("inst"!==c.type)throw Error("invalid chunk type:"+c.type);for(;e<h;)g.push({xa:String.fromCharCode.apply(null,f.subarray(e,e+=20)),da:f[e++]|f[e++]<<8});c=D(a,5);f=this.input;e=c.offset;g=this.ya=[];h=c.offset+c.size;if("ibag"!==c.type)throw Error("invalid chunk type:"+c.type);for(;e<h;)g.push({ea:f[e++]|f[e++]<<8,wa:f[e++]|f[e++]<<8});c=D(a,6);if("imod"!==c.type)throw Error("invalid chunk type:"+c.type);this.ga=
H(this,c);c=D(a,7);if("igen"!==c.type)throw Error("invalid chunk type:"+c.type);this.fa=I(this,c);h=D(a,8);a=this.input;c=h.offset;f=this.Ka=[];e=this.La=[];g=h.offset+h.size;var q,k,m,n,r,s,u;if("shdr"!==h.type)throw Error("invalid chunk type:"+h.type);for(;c<g;){h=String.fromCharCode.apply(null,a.subarray(c,c+=20));d=(a[c++]<<0|a[c++]<<8|a[c++]<<16|a[c++]<<24)>>>0;b=(a[c++]<<0|a[c++]<<8|a[c++]<<16|a[c++]<<24)>>>0;q=(a[c++]<<0|a[c++]<<8|a[c++]<<16|a[c++]<<24)>>>0;k=(a[c++]<<0|a[c++]<<8|a[c++]<<16|
a[c++]<<24)>>>0;m=(a[c++]<<0|a[c++]<<8|a[c++]<<16|a[c++]<<24)>>>0;n=a[c++];r=a[c++]<<24>>24;s=a[c++]|a[c++]<<8;u=a[c++]|a[c++]<<8;b=new Int16Array((new Uint8Array(a.subarray(this.qa.offset+2*d,this.qa.offset+2*b))).buffer);q-=d;k-=d;if(0<m){var w=m,z=void 0,y=void 0,F=void 0,E=void 0;for(d=1;22050>w;){z=new Int16Array(2*b.length);y=E=0;for(F=b.length;y<F;++y)z[E++]=b[y],z[E++]=b[y];b=z;d*=2;w*=2}m*=d;q*=d;k*=d}f.push(b);e.push({Va:h,Oa:q,ua:k,sampleRate:m,Da:n,Fa:r,Ua:s,Wa:u})}this.input=null};
function H(b,d){for(var a=b.input,c=d.offset,f=d.offset+d.size,e,g,h=[];c<f;){c+=2;e=a[c++]|a[c++]<<8;g=J[e];if(void 0===g)h.push({type:g,value:{code:e,d:a[c]|a[c+1]<<8<<16>>16,k:a[c++],i:a[c++]}});else switch(g){case "keyRange":case "velRange":case "keynum":case "velocity":h.push({type:g,value:{k:a[c++],i:a[c++]}});break;default:h.push({type:g,value:{d:a[c++]|a[c++]<<8<<16>>16}})}c+=2;c+=2}return h}
function I(b,d){for(var a=b.input,c=d.offset,f=d.offset+d.size,e,g,h=[];c<f;)if(e=a[c++]|a[c++]<<8,g=J[e],void 0===g)h.push({type:g,value:{code:e,d:a[c]|a[c+1]<<8<<16>>16,k:a[c++],i:a[c++]}});else switch(g){case "keynum":case "keyRange":case "velRange":case "velocity":h.push({type:g,value:{k:a[c++],i:a[c++]}});break;default:h.push({type:g,value:{d:a[c++]|a[c++]<<8<<16>>16}})}return h}
function K(b,d,a){var c=[],f={Pa:[],keyRange:{i:127,k:0}},e;for(e=b;e<d;++e)b=a[e],c.push(b),"unknown"===b.type?f.Pa.push(b.value):f[b.type]=b.value;return{u:f,v:c}}
var J=["startAddrsOffset","endAddrsOffset","startloopAddrsOffset","endloopAddrsOffset","startAddrsCoarseOffset","modLfoToPitch","vibLfoToPitch","modEnvToPitch","initialFilterFc","initialFilterQ","modLfoToFilterFc","modEnvToFilterFc","endAddrsCoarseOffset","modLfoToVolume",,"chorusEffectsSend","reverbEffectsSend","pan",,,,"delayModLFO","freqModLFO","delayVibLFO","freqVibLFO","delayModEnv","attackModEnv","holdModEnv","decayModEnv","sustainModEnv","releaseModEnv","keynumToModEnvHold","keynumToModEnvDecay",
"delayVolEnv","attackVolEnv","holdVolEnv","decayVolEnv","sustainVolEnv","releaseVolEnv","keynumToVolEnvHold","keynumToVolEnvDecay","instrument",,"keyRange","velRange","startloopAddrsCoarseOffset","keynum","velocity","initialAttenuation",,"endloopAddrsCoarseOffset","coarseTune","fineTune","sampleID","sampleModes",,"scaleTuning","exclusiveClass","overridingRootKey"];function L(b){var d;this.input=b;this.o=0;this.bufferSize=1024;if(void 0!==p.AudioContext)b=new p.AudioContext;else if(void 0!==p.webkitAudioContext)b=new p.webkitAudioContext;else if(void 0!==p.mozAudioContext)b=new p.mozAudioContext;else throw Error("Web Audio not supported");void 0===b.createGainNode&&(b.createGainNode=b.createGain);this.a=b;this.f=this.a.createGain();this.G=this.a.createBufferSource();this.r=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];this.aa=[127,127,127,127,127,127,127,127,127,127,127,
127,127,127,127,127];this.Y=[64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64];this.Z=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];this.L=[2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2];this.J=[127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127];this.$=[64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64];this.K=[!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1];this.I=[0,0,0,0,0,0,0,0,0,128,0,0,0,0,0,0];this.q=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];this.P=this.O=!1;this.X=[!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,
!1];this.c=[[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[]];this.sa=1/65535;this.l=Array(128);b=0;for(d=this.l.length;b<d;++b)this.l[b]=127;this.S=!0;this.A=this.a.createConvolver();this.w=this.a.createGain()}
var ha="Acoustic Piano;Bright Acoustic Piano;Electric Grand Piano;Honky-tonk Piano;Electric Piano;Electric Piano 2;Harpsichord;Clavi;Celesta;Glockenspiel;Musical box;Vibraphone;Marimba;Xylophone;Tubular Bell;Dulcimer;Drawbar Organ;Percussive Organ;Rock Organ;Church organ;Reed organ;Accordion;Harmonica;Tango Accordion;Acoustic Guitar (nylon);Acoustic Guitar (steel);Electric Guitar (jazz);Electric Guitar (clean);Electric Guitar (muted);Overdriven Guitar;Distortion Guitar;Guitar Harmonics;Acoustic Bass;Electric Bass (finger);Electric Bass (pick);Fretless Bass;Slap Bass 1;Slap Bass 2;Synth Bass 1;Synth Bass 2;Violin;Viola;Cello;Double bass;Tremolo Strings;Pizzicato Strings;Orchestral Harp;Timpani;String Ensemble 1;String Ensemble 2;Synth Strings 1;Synth Strings 2;Voice Aahs;Voice Oohs;Synth Voice;Orchestra Hit;Trumpet;Trombone;Tuba;Muted Trumpet;French horn;Brass Section;Synth Brass 1;Synth Brass 2;Soprano Sax;Alto Sax;Tenor Sax;Baritone Sax;Oboe;English Horn;Bassoon;Clarinet;Piccolo;Flute;Recorder;Pan Flute;Blown Bottle;Shakuhachi;Whistle;Ocarina;Lead 1 (square);Lead 2 (sawtooth);Lead 3 (calliope);Lead 4 (chiff);Lead 5 (charang);Lead 6 (voice);Lead 7 (fifths);Lead 8 (bass + lead);Pad 1 (new age);Pad 2 (warm);Pad 3 (polysynth);Pad 4 (choir);Pad 5 (bowed);Pad 6 (metallic);Pad 7 (halo);Pad 8 (sweep);FX 1 (rain);FX 2 (soundtrack);FX 3 (crystal);FX 4 (atmosphere);FX 5 (brightness);FX 6 (goblins);FX 7 (echoes);FX 8 (sci-fi);Sitar;Banjo;Shamisen;Koto;Kalimba;Bagpipe;Fiddle;Shanai;Tinkle Bell;Agogo;Steel Drums;Woodblock;Taiko Drum;Melodic Tom;Synth Drum;Reverse Cymbal;Guitar Fret Noise;Breath Noise;Seashore;Bird Tweet;Telephone Ring;Helicopter;Applause;Gunshot".split(";"),ia=
"Standard Set;;;;;;;;Room Set;;;;;;;;Power Set;;;;;;;;Electronic Set;Analog Set;;;;;;;Jazz Set;;;;;;;;Brush Set;;;;;;;;Orchestra Set;;;;;;;;SFX Set;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;".split(";");function M(b){var d;b.la=new G(b.input);b.p=P(b);b.P=!1;b.O=!1;for(d=0;16>d;++d)Q(b,d,0),R(b,d,100),S(b,d,64),b.m(d,0,64),b.n(d,2),b.K[d]=!1,b.J[d]=127,b.I[d]=9===d?128:0,b.q[d]=0;for(d=0;128>d;++d)b.l[d]=127}
function P(b){var d,a,c,f,e;b=b.la;b.parse();var g=b.Ha,h=b.Ja,q=[],k,m,n,r,s;r=0;for(s=g.length;r<s;++r){k=g[r].ma;m=g[r+1]?g[r+1].ma:h.length;for(n=[];k<m;++k)e=K(h[k].na,h[k+1]?h[k+1].na:b.oa.length,b.oa),c=e.u,d=e.v,f=K(h[k].R,h[k+1]?h[k+1].R:b.pa.length,b.pa),e=f.u,f=f.v,n.push({ca:c,va:d,Ba:e,Ca:f}),c=void 0!==c.instrument?c.instrument.d:void 0!==e.instrument?e.instrument.d:null;q.push({name:g[r].Ia,info:n,t:g[r],b:c})}h=b.b;n=b.ya;g=[];s=0;for(k=h.length;s<k;++s){m=h[s].da;c=h[s+1]?h[s+1].da:
n.length;r=[];for(e=c;m<e;++m)d=K(n[m].ea,n[m+1]?n[m+1].ea:b.fa.length,b.fa),c=d.u,f=d.v,a=K(n[m].R,n[m+1]?n[m+1].wa:b.ga.length,b.ga),d=a.u,a=a.v,r.push({ca:c,va:f,Ba:d,Ca:a});g.push({name:h[s].xa,info:r})}h=[];k=0;for(m=q.length;k<m;++k)if(c=q[k],s=c.t.Ga,"number"===typeof c.b&&(r=g[c.b],"EOI"!==r.name.replace(/\0*$/,"")))for(void 0===h[c.t.o]&&(h[c.t.o]=[]),n=h[c.t.o],n[s]=[],n[s].name=c.name,c=0,e=r.info.length;c<e;++c){d=b;f=n[s];a=r.info[c].ca;var u=void 0,w=void 0,z=void 0,y=void 0,F=void 0,
E=void 0,X=void 0,Y=void 0,Z=void 0,$=void 0,aa=void 0,ba=void 0,ca=void 0,da=void 0,ea=void 0,N=void 0,O=void 0,x=void 0,fa=void 0;if(void 0!==a.keyRange&&void 0!==a.sampleID)for(z=T(a,"delayVolEnv",-12E3),y=T(a,"attackVolEnv",-12E3),F=T(a,"holdVolEnv",-12E3),E=T(a,"decayVolEnv",-12E3),X=T(a,"sustainVolEnv"),Y=T(a,"releaseVolEnv",-12E3),Z=T(a,"delayModEnv",-12E3),$=T(a,"attackModEnv",-12E3),aa=T(a,"holdModEnv",-12E3),ba=T(a,"decayModEnv",-12E3),ca=T(a,"sustainModEnv"),da=T(a,"releaseModEnv",-12E3),
ea=T(a,"coarseTune")+T(a,"fineTune")/100,N=T(a,"scaleTuning",100)/100,O=T(a,"freqVibLFO"),x=a.keyRange.k,fa=a.keyRange.i;x<=fa;++x)f[x]||(u=T(a,"sampleID"),w=d.La[u],f[x]={sample:d.Ka[u],sampleRate:w.sampleRate,sampleModes:T(a,"sampleModes"),basePlaybackRate:Math.pow(Math.pow(2,1/12),(x-T(a,"overridingRootKey",w.Da)+ea+w.Fa/100)*N),modEnvToPitch:T(a,"modEnvToPitch")/100,scaleTuning:N,start:32768*T(a,"startAddrsCoarseOffset")+T(a,"startAddrsOffset"),end:32768*T(a,"endAddrsCoarseOffset")+T(a,"endAddrsOffset"),
loopStart:w.Oa+32768*T(a,"startloopAddrsCoarseOffset")+T(a,"startloopAddrsOffset"),loopEnd:w.ua+32768*T(a,"endloopAddrsCoarseOffset")+T(a,"endloopAddrsOffset"),volDelay:Math.pow(2,z/1200),volAttack:Math.pow(2,y/1200),volHold:Math.pow(2,F/1200)*Math.pow(2,(60-x)*T(a,"keynumToVolEnvHold")/1200),volDecay:Math.pow(2,E/1200)*Math.pow(2,(60-x)*T(a,"keynumToVolEnvDecay")/1200),volSustain:X/1E3,volRelease:Math.pow(2,Y/1200),modDelay:Math.pow(2,Z/1200),modAttack:Math.pow(2,$/1200),modHold:Math.pow(2,aa/1200)*
Math.pow(2,(60-x)*T(a,"keynumToModEnvHold")/1200),modDecay:Math.pow(2,ba/1200)*Math.pow(2,(60-x)*T(a,"keynumToModEnvDecay")/1200),modSustain:ca/1E3,modRelease:Math.pow(2,da/1200),initialFilterFc:T(a,"initialFilterFc",13500),modEnvToFilterFc:T(a,"modEnvToFilterFc"),initialFilterQ:T(a,"initialFilterQ"),reverbEffectSend:T(a,"reverbEffectSend"),initialAttenuation:T(a,"initialAttenuation"),freqVibLFO:O?8.176*Math.pow(2,O/1200):void 0})}return h}
function T(b,d,a){void 0===a&&(a=0);return b[d]?b[d].d:a}L.prototype.connect=function(){this.G.connect(this.f);this.f.connect(this.a.destination);this.S&&ja(this)};function ja(b){b.f.connect(b.A);b.A.connect(b.w);b.w.connect(b.a.destination)}L.prototype.start=function(){this.connect();this.G.start(0);U(this,16383)};function U(b,d){b.f.gain.value=d/16384*b.sa}L.prototype.stop=L.prototype.disconnect=function(){this.G.disconnect(0);this.f.disconnect(0);this.A.disconnect(0);this.w.disconnect(0)};
L.prototype.T=function(b){this.S!==b&&(this.A.disconnect(0),this.w.disconnect(0),(this.S=b)&&ja(this))};var V="Instrument;Vol;Pan;Bend;Range;GM Mode".split(";");
function ka(b){var d=b.table=document.createElement("table"),a=document.createElement("thead"),c=document.createElement("tbody"),f,e,g,h,q,k;a.appendChild(la(V,!0));for(k=0;16>k;++k){f=la(V.length+128,!1);c.appendChild(f);e=f.querySelector("td:nth-child(1)");g=document.createElement("input");g.setAttribute("type","checkbox");g.addEventListener("change",function(a,c){return function(){var b=this.checked,d=a.c[c],e;if(a.X[c]=b)for(b=0,e=d.length;b<e;++b)d[b].disconnect();else for(b=0,e=d.length;b<e;++b)d[b].connect()}}(b,
k),!1);e.appendChild(g);h=document.createElement("select");for(g=0;128>g;++g){var m=9!==k?ha[g]:ia[g];q=document.createElement("option");""!==m&&(q.textContent=m,q.value=g,h.appendChild(q))}e.appendChild(h);h.addEventListener("change",function(a,b){return function(c){Q(a,b,c.target.value)}}(b,k),!1);h.selectedIndex=b.r[k];f=f.querySelectorAll("td:nth-last-child(-n+128)");for(g=0;128>g;++g)f[g].addEventListener("mousedown",function(a,b,c){return function(d){d.preventDefault();a.ba=!0;a.noteOn(b,c,
127)}}(b,k,g)),f[g].addEventListener("mouseover",function(a,b,c){return function(d){d.preventDefault();a.ba&&a.noteOn(b,c,127)}}(b,k,g)),f[g].addEventListener("mouseout",function(a,b,c){return function(d){d.preventDefault();a.noteOff(b,c,0)}}(b,k,g)),f[g].addEventListener("mouseup",function(a,b,c){return function(d){d.preventDefault();a.ba=!1;a.noteOff(b,c,0)}}(b,k,g))}d.appendChild(a);d.appendChild(c);return d}
function la(b,d){var a=document.createElement("tr"),c,f=b instanceof Array,e,g=f?b.length:b;for(e=0;e<g;++e)c=document.createElement(d?"th":"td"),c.textContent=f&&void 0!==b[e]?b[e]:"",d&&g===e+1&&c.setAttribute("colspan",129),a.appendChild(c);return a}l=L.prototype;
l.noteOn=function(b,d,a){var c=this.I[b],f=128;this.P?(f=127,64===c?c=125:0!==this.q[b]&&0!==c&&126!==c&&127!==c&&(c=this.q[b]),this.table.querySelector("thead > tr:first-child > th:nth-child(6)").innerText="XG Mode"):this.O?this.table.querySelector("thead > tr:first-child > th:nth-child(6)").innerText="GS Mode":(this.table.querySelector("thead > tr:first-child > th:nth-child(6)").innerText="GM Mode",c=0);9==b&&(c=f);var e=void 0!==this.p[c]?this.p[c]:this.p[9===b?f:0],f=e[this.r[b]];if(this.table){var g=
this.table.querySelector("tbody > tr:nth-child("+(b+1)+") > td:nth-child("+(V.length+d+1)+")");g.classList.add("note-on");g.style.opacity=a/127}f||(f=e[c]);(e=f[d]||e[0])?(c=this.Y[b]-64,e.channel=b,e.key=d,e.velocity=a,e.panpot=c/(0>c?64:63),e.volume=this.aa[b]/127,e.pitchBend=this.Z[b]-8192,e.expression=this.J[b],e.pitchBendSensitivity=this.L[b],e.mute=this.X[b],e.releaseTime=this.$[b],9===b&&(f.volume*=this.l[d]/127),d=new v(this.a,this.f,e),d.noteOn(),this.c[b].push(d)):p.console.warn("instrument not found: bank=%s instrument=%s channel=%s key=%s",
c,this.r[b],b,d)};l.noteOff=function(b,d){var a,c,f=this.c[b],e,g=this.K[b];this.table&&(a=this.table.querySelector("tbody > tr:nth-child("+(b+1)+") > td:nth-child("+(d+V.length+1)+")"),a.classList.remove("note-on"),a.style.opacity=1);a=0;for(c=f.length;a<c;++a)e=f[a],e.key===d&&(e.noteOff(),g||(e.release(),f.splice(a,1),--a,--c))};function ma(b,d,a){var c=b.c[d];if(!(b.K[d]=!(64>a)))for(d=0,a=c.length;d<a;++d)b=c[d],b.ja&&(b.release(),c.splice(d,1),--d,--a)}
function Q(b,d,a){b.table&&(b.table.querySelector("tbody > tr:nth-child("+(d+1)+") > td:first-child > select").value=a);b.r[d]=a}function R(b,d,a){b.table&&(b.table.querySelector("tbody > tr:nth-child("+(d+1)+") > td:nth-child(2)").textContent=a);b.aa[d]=a}l.h=function(b,d){var a,c,f=this.c[b];a=0;for(c=f.length;a<c;++a){var e=f[a];e.s.gain.value=(e.h=d)/127}this.J[b]=d};
function S(b,d,a){b.table&&(b.table.querySelector("tbody > tr:nth-child("+(d+1)+") > td:nth-child(3)").textContent=a);b.Y[d]=a}l.m=function(b,d,a){d=d&127|(a&127)<<7;var c,f=this.c[b],e=d-8192;this.table&&(this.table.querySelector("tbody > tr:nth-child("+(b+1)+") > td:nth-child(4)").textContent=e);a=0;for(c=f.length;a<c;++a)A(f[a],e);this.Z[b]=d};l.n=function(b,d){this.table&&(this.table.querySelector("tbody > tr:nth-child("+(b+1)+") > td:nth-child(5)").textContent=d);this.L[b]=d};function W(){this.V=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];this.U=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];this.F=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];this.D=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];this.za=this.onmessage.bind(this);this.g=!0;window.addEventListener("DOMContentLoaded",function(){this.ready=!0}.bind(this),!1)}l=W.prototype;l.Na=function(b){this.ready?this.load(b):window.addEventListener("DOMContentLoaded",function a(){window.removeEventListener("DOMContentLoaded",a,!1);this.load(b)}.bind(this),!1)};
l.load=function(b){var d;this.H();d=this.C=new XMLHttpRequest;d.open("GET",b,!0);d.responseType="arraybuffer";d.addEventListener("load",function(a){a=a.target;this.onload(a.response);"function"===typeof this.ha&&this.ha(a.response);this.C=null}.bind(this),!1);d.send()};l.T=function(b){this.B.T(b)};l.H=function(){this.C&&(this.C.abort(),this.C=null)};l.onload=function(b){b=new Uint8Array(b);this.ia(b)};
l.ia=function(b){var d;this.H();this.B?(d=this.B,d.input=b,d.la=new G(b),d.p=P(d)):(d=this.B=new L(b),document.body.appendChild(ka(d)),M(d),d.start(),window.addEventListener("message",this.za,!1));window.opener?window.opener.postMessage("link,ready","*"):window.parent!==window&&window.parent.postMessage("link,ready","*")};
l.onmessage=function(b){b=b.data.split(",");switch(b.shift()){case "midi":na(this,b.map(function(b){return parseInt(b,16)}));break;case "link":b=b.shift();switch(b){case "reqpatch":window.opener?window.opener.postMessage("link,patch","*"):window.parent!==window&&window.parent.postMessage("link,patch","*");break;case "setpatch":break;default:p.console.error("unknown link message:",b)}break;default:p.console.error("unknown message type")}};l.Ma=function(b){this.ha=b};
function na(b,d){var a=d[0]&15,c=b.B;switch(d[0]&240){case 128:c.noteOff(a,d[1],d[2]);break;case 144:0<d[2]?c.noteOn(a,d[1],d[2]):c.noteOff(a,d[1],0);break;case 176:switch(d[1]){case 0:c.I[a]=d[2];break;case 6:if(b.g)switch(b.F[a]){case 0:switch(b.D[a]){case 0:c.n(a,d[2])}}else switch(b.V[a]){case 26:c.l[b.U[a]]=d[2]}break;case 38:if(b.g)switch(b.F[a]){case 0:switch(b.D[a]){case 0:c.n(a,c.L[a]+d[2]/100)}}break;case 7:R(c,a,d[2]);break;case 10:S(c,a,d[2]);break;case 120:for(var f=c.c[a],e;0<f.length;)e=
f.shift(),c.noteOff(a,e.key,0),e.release(),e.disconnect();break;case 121:c.h(a,127);c.m(a,0,64);ma(c,a,0);break;case 32:c.q[a]=d[2];break;case 98:b.g=!1;b.U[a]=d[2];break;case 99:b.g=!1;b.V[a]=d[2];break;case 100:b.g=!0;b.D[a]=d[2];break;case 101:b.g=!0;b.F[a]=d[2];break;case 64:ma(c,a,d[2]);break;case 11:c.h(a,d[2]);break;case 74:c.$[a]=d[2]}break;case 192:Q(c,a,d[1]);break;case 224:c.m(a,d[1],d[2]);break;case 240:switch(d[1]){case 126:127===d[2]&&9===d[3]&&1===d[4]&&M(c);break;case 127:switch(d[3]){case 4:switch(d[4]){case 1:U(c,
d[5]+(d[6]<<7))}}}switch(d[2]){case 67:switch(d[7]){case 4:U(c,d[8]<<7);break;case 126:M(c),c.P=!0}break;case 65:switch(d[8]){case 4:U(c,d[9]<<7);break;case 127:M(c),c.O=!0}}}};t("SoundFont.WebMidiLink",W);t("SoundFont.WebMidiLink.prototype.setup",W.prototype.Na);t("SoundFont.WebMidiLink.prototype.loadSoundFont",W.prototype.ia);t("SoundFont.WebMidiLink.prototype.cancelLoading",W.prototype.H);t("SoundFont.WebMidiLink.prototype.setLoadCallback",W.prototype.Ma);t("SoundFont.WebMidiLink.prototype.setReverb",W.prototype.T);}).call(this); //@ sourceMappingURL=sf2synth.min.js.map
